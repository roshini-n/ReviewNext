import{A as l,C as g,D as c,E as B,F as s,H as h,M as y,O as D,P as p,y as m}from"./chunk-VRLREQ5H.js";import{a as d,b,ea as u,ka as f,s as r,t as k,y as i}from"./chunk-5JKIZQAZ.js";var v=class n{firestore=f(m);booksCollection=c(this.firestore,"books");getBooks(){return l(this.booksCollection,{idField:"id"}).pipe(i(o=>o.map(e=>this.mapToBookModel(e))))}getBookById(o){let e=s(this.firestore,`books/${o}`);return r(h(e)).pipe(i(t=>{if(t.exists()){let a=t.data();return this.mapToBookModel(d({id:t.id},a))}}))}addBook(o){let e=c(this.firestore,"books");return r(g(e,o).then(()=>{}))}updateBook(o){let e=s(this.firestore,`books/${o.id}`);return r(D(e,b(d({},o),{lastUpdated:new Date})))}deleteBook(o){let e=s(this.firestore,`books/${o}`);return B(e)}searchBooks(o,e){if(!o||o.trim()==="")return k([]);let t=y(this.booksCollection,p(e,">=",o),p(e,"<=",o+"\uF8FF"));return l(t,{idField:"id"}).pipe(i(a=>a.map(R=>this.mapToBookModel(R))))}mapToBookModel(o){return{id:o.id||"",title:o.title||"",description:o.description||"",author:o.author||"",publisher:o.publisher||"",publicationDate:o.publicationDate||"",genres:Array.isArray(o.genres)?o.genres:[],pages:o.pages||0,readersRead:o.readersRead||0,rating:o.rating||0,imageUrl:o.imageUrl||"",totalRatingScore:o.totalRatingScore||0,numRatings:o.numRatings||0,dateAdded:o.dateAdded||new Date().toISOString()}}static \u0275fac=function(e){return new(e||n)};static \u0275prov=u({token:n,factory:n.\u0275fac,providedIn:"root"})};export{v as a};
