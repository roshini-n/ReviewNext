import{A as c,C as G,D as u,E as h,F as l,G as D,H as R,I as O,M as f,O as I,P as m,y as v}from"./chunk-VRLREQ5H.js";import{a as d,ea as y,ka as b,s as o,t as n,u as g,y as s}from"./chunk-5JKIZQAZ.js";var w=class p{firestore=b(v);gamesCollection=u(this.firestore,"games");getGames(){return c(this.gamesCollection,{idField:"id"}).pipe(s(e=>e.map(r=>this.mapToGameModel(r))))}getGameById(e){let r=l(this.firestore,`games/${e}`);return o(R(r)).pipe(s(i=>{if(i.exists()){let t=i.data();return this.mapToGameModel(d({id:i.id},t))}}))}getGamesByIds(e){if(e.length===0)return n([]);let r=e.filter(t=>t!=null&&t!=="");if(r.length===0)return n([]);let i=f(this.gamesCollection,m(D(),"in",r));return o(O(i)).pipe(s(t=>t.docs.map(a=>this.mapToGameModel(d({id:a.id},a.data())))))}mapToGameModel(e){return{id:e.id||"",title:e.title||"",description:e.description||"",platforms:Array.isArray(e.platforms)?e.platforms:[],releaseDate:e.releaseDate||"",developer:e.developer||"",publisher:e.publisher||"",rating:e.rating||0,imageUrl:e.imageUrl||"",playersPlayed:e.playersPlayed||0,numRatings:e.numRatings||0,totalRatingScore:e.totalRatingScore||0}}addGame(e){let r=u(this.firestore,"games");return o(G(r,e).then(()=>{}))}searchGames(e,r){if(console.log("Service searching for:",e),!e||e.trim()==="")return n([]);let i=e.toLowerCase(),t=f(this.gamesCollection,m(r,">=",e),m(r,"<=",e+"\uF8FF"));return console.log("Query:",t),c(t,{idField:"id"}).pipe(s(a=>a.map(C=>this.mapToGameModel(C))))}updateGame(e){if(!e.id)return g(()=>new Error("Game ID is required for update"));let r=l(this.firestore,`games/${e.id}`);return o(I(r,{title:e.title,description:e.description,platforms:e.platforms,releaseDate:e.releaseDate,developer:e.developer,publisher:e.publisher,rating:e.rating,imageUrl:e.imageUrl,playersPlayed:e.playersPlayed,numRatings:e.numRatings,totalRatingScore:e.totalRatingScore}))}deleteGame(e){let r=l(this.firestore,"games",e);return o(h(r))}static \u0275fac=function(r){return new(r||p)};static \u0275prov=y({token:p,factory:p.\u0275fac,providedIn:"root"})};export{w as a};
